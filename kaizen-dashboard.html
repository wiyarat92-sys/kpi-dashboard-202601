<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaizen Executive Summary - Jan 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Kanit -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f8fafc;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .modal {
            transition: opacity 0.25s ease;
        }
        body.modal-active {
            overflow-x: hidden;
            overflow-y: visible !important;
        }
        /* Custom Scrollbar for Modal */
        .modal-content::-webkit-scrollbar {
            width: 8px;
        }
        .modal-content::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .modal-content::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .list-custom ul {
            list-style-type: disc;
            padding-left: 1.25rem;
        }
        .list-custom ol {
            list-style-type: decimal;
            padding-left: 1.25rem;
        }
    </style>
</head>
<body class="text-slate-900 antialiased">

    <div class="min-h-screen p-4 md:p-8 lg:p-12 relative">
        <!-- Header Section -->
        <div class="max-w-7xl mx-auto mb-10">
            <div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100 flex flex-col md:flex-row items-center justify-between gap-6 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-blue-50 rounded-full -mr-16 -mt-16 opacity-50 z-0"></div>
                
                <div class="relative z-10">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold uppercase tracking-wider">Jan 2026 Report</span>
                        <span class="text-slate-400 text-sm">|</span>
                        <span class="text-slate-500 text-sm font-medium">บริษัท พัฒนาสิน ไทยเทรดดิ้ง จำกัด</span>
                    </div>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-slate-800 tracking-tight mt-2">
                        Kaizen Executive Dashboard
                    </h1>
                    <p class="text-slate-500 text-lg mt-2">สรุปภาพรวมการเสนอแนะหัวข้อไคเซ็นเพื่อการพัฒนาองค์กร</p>
                </div>

                <div class="relative z-10 flex items-center gap-4">
                    <div class="text-right hidden md:block">
                        <p class="text-sm text-slate-400 font-medium">Total Proposals</p>
                        <p class="text-3xl font-black text-slate-800">7 <span class="text-lg font-normal text-slate-400">หัวข้อ</span></p>
                    </div>
                    <div class="bg-blue-600 text-white p-4 rounded-2xl shadow-lg shadow-blue-200">
                        <i data-lucide="file-bar-chart-2" class="w-8 h-8"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto space-y-8">
            <!-- Key Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 card-hover transition-all duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <div class="bg-blue-50 p-3 rounded-xl">
                            <i data-lucide="timer" class="w-6 h-6 text-blue-600"></i>
                        </div>
                        <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-lg">71%</span>
                    </div>
                    <h3 class="text-2xl font-bold text-slate-800">ลดเวลางาน</h3>
                    <p class="text-sm text-slate-500 mt-1">เป้าหมายหลัก (5 หัวข้อ)</p>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 card-hover transition-all duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <div class="bg-emerald-50 p-3 rounded-xl">
                            <i data-lucide="shield-check" class="w-6 h-6 text-emerald-600"></i>
                        </div>
                        <span class="text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-lg">Safety</span>
                    </div>
                    <h3 class="text-2xl font-bold text-slate-800">1 โครงการ</h3>
                    <p class="text-sm text-slate-500 mt-1">ด้านความปลอดภัย</p>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 card-hover transition-all duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <div class="bg-purple-50 p-3 rounded-xl">
                            <i data-lucide="users" class="w-6 h-6 text-purple-600"></i>
                        </div>
                        <span class="text-xs font-bold text-purple-600 bg-purple-50 px-2 py-1 rounded-lg">Active</span>
                    </div>
                    <h3 class="text-2xl font-bold text-slate-800">4 ระดับ</h3>
                    <p class="text-sm text-slate-500 mt-1">ผจก./หก. ร่วมเสนอแนะ</p>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 card-hover transition-all duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <div class="bg-rose-50 p-3 rounded-xl">
                            <i data-lucide="trending-up" class="w-6 h-6 text-rose-600"></i>
                        </div>
                        <span class="text-xs font-bold text-rose-600 bg-rose-50 px-2 py-1 rounded-lg">Growth</span>
                    </div>
                    <h3 class="text-2xl font-bold text-slate-800">5 หัวข้อ</h3>
                    <p class="text-sm text-slate-500 mt-1">เพิ่มยอดขาย/คุณภาพ</p>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-100">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-1 h-6 bg-blue-500 rounded-full"></div>
                        <h3 class="text-lg font-bold text-slate-800">วัตถุประสงค์ของโครงการ</h3>
                    </div>
                    <div class="h-[300px] w-full">
                        <canvas id="objectiveChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-100">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-1 h-6 bg-rose-500 rounded-full"></div>
                        <h3 class="text-lg font-bold text-slate-800">พื้นที่การปรับปรุง (Location)</h3>
                    </div>
                    <div class="h-[300px] w-full flex justify-center">
                        <canvas id="locationChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden" id="table-section">
                <div class="p-8 border-b border-slate-100 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                    <div>
                        <h3 class="text-xl font-bold text-slate-800">ทำเนียบรายละเอียดโครงการ</h3>
                        <p class="text-sm text-slate-500 mt-1">คลิกที่ปุ่ม <span class="font-bold text-blue-600">"ดูรายละเอียด"</span> เพื่อดูข้อมูลเชิงลึกของแต่ละหัวข้อ</p>
                    </div>
                    <button class="flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-blue-600 transition-colors cursor-pointer bg-slate-50 px-4 py-2 rounded-lg border border-slate-200">
                        <i data-lucide="download" class="w-4 h-4"></i>
                        Export Data
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-slate-50/50 border-y border-slate-100">
                                <th class="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider w-[30%]">ผู้เสนอ / ID</th>
                                <th class="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider w-[30%]">หัวข้อการปรับปรุง</th>
                                <th class="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider hidden md:table-cell">ประเภท/สถานที่</th>
                                <th class="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right">จัดการ</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-slate-100">
                            <!-- Javascript will inject rows here -->
                        </tbody>
                    </table>
                </div>
                <div class="p-4 bg-slate-50 text-center border-t border-slate-100">
                    <p class="text-xs text-slate-400">Generated by Kaizen Executive Dashboard System</p>
                </div>
            </div>
        </div>

        <!-- Modal Overlay -->
        <div id="kaizenModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50 p-4">
            <div class="modal-overlay absolute w-full h-full bg-slate-900 opacity-60 backdrop-blur-sm"></div>
            
            <div class="modal-container bg-white w-full md:max-w-2xl mx-auto rounded-2xl shadow-2xl z-50 overflow-hidden transform scale-95 transition-transform duration-300 flex flex-col max-h-[90vh]">
                
                <!-- Modal Content -->
                <div class="modal-content overflow-y-auto p-6 md:p-8">
                    <!-- Title -->
                    <div class="flex justify-between items-start pb-4 border-b border-slate-100 mb-6">
                        <div>
                            <span class="inline-block py-1 px-2 rounded bg-slate-100 text-slate-500 text-xs font-mono font-bold mb-2" id="modalId">ID: KZ-XXXX-XX</span>
                            <h2 class="text-2xl font-bold text-slate-800 leading-snug" id="modalTopic">หัวข้อการปรับปรุง</h2>
                        </div>
                        <div class="modal-close cursor-pointer z-50 p-2 bg-slate-100 rounded-full hover:bg-slate-200 transition-colors flex-shrink-0 ml-4" onclick="closeModal()">
                            <i data-lucide="x" class="w-5 h-5 text-slate-500"></i>
                        </div>
                    </div>

                    <!-- Body -->
                    <div class="space-y-6">
                        <!-- User Info Section -->
                        <div class="flex items-center gap-4 bg-slate-50 p-4 rounded-2xl border border-slate-100">
                            <div class="w-14 h-14 rounded-full bg-white flex items-center justify-center border border-slate-200 shadow-sm text-xl font-bold text-blue-600 flex-shrink-0">
                                <i data-lucide="user" class="w-7 h-7"></i>
                            </div>
                            <div class="flex-grow">
                                <p class="text-lg font-bold text-slate-800" id="modalName">ชื่อ-นามสกุล</p>
                                <p class="text-sm text-slate-500" id="modalPos">ตำแหน่ง</p>
                            </div>
                            <div class="text-right hidden sm:block">
                                <div class="flex items-center gap-1.5 text-slate-500 text-sm justify-end bg-white px-3 py-1 rounded-full border border-slate-200">
                                    <i data-lucide="map-pin" class="w-3.5 h-3.5 text-rose-500"></i>
                                    <span id="modalLoc">สถานที่</span>
                                </div>
                            </div>
                        </div>

                        <!-- Categories -->
                        <div id="modalBadges" class="flex flex-wrap gap-2"></div>

                        <!-- Details Grid -->
                        <div class="grid grid-cols-1 gap-4 list-custom">
                            <div class="bg-rose-50/40 p-5 rounded-xl border border-rose-100/60">
                                <h4 class="font-bold text-rose-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="alert-triangle" class="w-5 h-5"></i> สภาพปัญหาปัจจุบัน
                                </h4>
                                <div class="text-sm text-slate-700 leading-relaxed space-y-2" id="modalProblem"></div>
                            </div>
                            
                            <div class="bg-blue-50/40 p-5 rounded-xl border border-blue-100/60">
                                <h4 class="font-bold text-blue-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="lightbulb" class="w-5 h-5"></i> รายละเอียดการปรับปรุง
                                </h4>
                                <div class="text-sm text-slate-700 leading-relaxed space-y-2" id="modalSolution"></div>
                            </div>

                            <div class="bg-emerald-50/40 p-5 rounded-xl border border-emerald-100/60">
                                <h4 class="font-bold text-emerald-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="check-circle-2" class="w-5 h-5"></i> ประโยชน์ที่ได้รับ
                                </h4>
                                <div class="text-sm text-slate-700 leading-relaxed space-y-2" id="modalBenefit"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer (Fixed) -->
                <div class="p-6 bg-slate-50 border-t border-slate-100 flex justify-end gap-3 flex-shrink-0">
                    <button class="px-5 py-2.5 bg-white text-slate-600 font-medium rounded-xl border border-slate-200 hover:bg-slate-50 transition shadow-sm" onclick="closeModal()">ปิดหน้าต่าง</button>
                    <button class="px-5 py-2.5 bg-blue-600 text-white font-bold rounded-xl shadow-lg shadow-blue-200 hover:bg-blue-700 transition flex items-center gap-2" onclick="closeModal()">
                        <i data-lucide="thumbs-up" class="w-4 h-4"></i> รับทราบ/อนุมัติ
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- 1. ข้อมูล (Data) อัปเดตจากเอกสารจริง ---
        const kaizenData = [
            { 
                id: 'KZ-2601-02', 
                name: 'น.ส.ภคพร สีแวงนอก', 
                pos: 'หัวหน้าแผนกบัญชี/การเงิน', 
                topic: 'ส่วนลดพิเศษชำระเงินตามเงื่อนไข', 
                cats: ['เพิ่มคุณภาพ'], 
                loc: 'สำนักงาน',
                problem: 'การติดตามการชำระหนี้กับลูกค้ามีปัญหาการชำระไม่ตรงกำหนด และลูกค้าบางรายก็ลืมจ่าย ทำให้เกิดปัญหาการชำระล่าช้า ส่งผลเสียให้บริษัทขาดสภาพคล่องเงินสดและแบกรับดอกเบี้ย',
                solution: '<ul><li>ส่งใบแจ้งเงื่อนไขการชำระเงินให้ลูกค้าผ่านไลน์กลุ่ม ภายหลังจากที่ฝ่ายขายส่งรายละเอียดจัดส่งให้ลูกค้าในแต่ละวัน</li><li>รายละเอียดที่แจ้งประกอบด้วย: 1.เลขที่บิล 2.ชื่อร้านค้า 3.วันที่ชำระ</li></ul>',
                benefit: '<ul><li>เป็นแรงจูงใจให้ลูกค้าชำระเงินเร็วขึ้นเพื่อให้ได้ส่วนลดเงินสด</li><li>ส่งเสริมการชำระเงินที่สม่ำเสมอ ช่วยลดปัญหาการชำระล่าช้า</li></ul>'
            },
            { 
                id: 'KZ-2601-03', 
                name: 'น.ส.วิญารัตน์ พิบาลขัน', 
                pos: 'ผู้จัดการฝ่ายบริหาร', 
                topic: 'การจัดการสินค้า Dead Stock', 
                cats: ['เพิ่มยอดขาย', 'ลดเวลางาน'], 
                loc: 'คลังสินค้า',
                problem: 'สินค้าบางรายการไม่มีการเคลื่อนไหวเป็นเวลานาน ถูกจัดเก็บรวมกับสินค้าปกติ ทำให้สิ้นเปลืองพื้นที่คลังสินค้า เกิดต้นทุนจม และพนักงานขายไม่ทราบข้อมูลเพื่อนำไปเสนอขาย',
                solution: '<ul><li>กำหนดประเภท Dead Stock เป็น 5 กลุ่ม (เคลื่อนไหวช้า, หมดอายุ, ชำรุด, คืน, ตามฤดูกาล)</li><li>ระบุสถานะสินค้าให้ชัดเจนและจัดโปรโมชั่นระบายสินค้า</li><li>แจ้งข้อมูลให้ทีมขายรับทราบเพื่อเสนอขายลูกค้า และติดตามผลทุกเดือน</li></ul>',
                benefit: '<ul><li>ลดปริมาณสินค้า Dead Stock ในคลังสินค้า</li><li>ลดต้นทุนการจัดเก็บ</li><li>เพิ่มการหมุนเวียนสินค้าและเปลี่ยนเป็นเงินสด</li></ul>'
            },
            { 
                id: 'KZ-2601-04', 
                name: 'น.ส.วิชิตา สีแวงนอก', 
                pos: 'พนักงานจัดซื้อ', 
                topic: 'ปรับปรุงจุดสั่งซื้อสินค้า ROP', 
                cats: ['ลดต้นทุน', 'ลดเวลางาน', 'เพิ่มประสิทธิภาพ'], 
                loc: 'คลังสินค้า',
                problem: 'จำนวนสต๊อคสินค้าไม่เหมาะสม (ขาด/ล้น) ไม่ทันกับความต้องการของลูกค้า ทำให้เสียโอกาสในการขายเมื่อลูกค้าต้องการสินค้าแล้วไม่มีของ',
                solution: '<ul><li>ตรวจสอบข้อมูลยอดขายจริง Lead Time และความผันผวน</li><li>กำหนดจุดสั่งซื้อ (ROP) ใหม่ โดยใช้สูตร: ยอดขายเฉลี่ย x Leadtime x Safety Stock 30-50%</li><li>ตั้งค่าจุดสั่งซื้อในโปรแกรม SML เพื่อแจ้งเตือนการสั่งซื้อทันทีเมื่อถึงกำหนด</li></ul>',
                benefit: '<ul><li>ลดความเสี่ยงสินค้าหมดสต๊อกที่ส่งผลให้เสียโอกาสในการขาย</li><li>ป้องกันการสั่งซื้อสินค้าที่มากเกินไป</li><li>ช่วยคำนวณการสต๊อคสินค้าได้อย่างเหมาะสม</li></ul>'
            },
            { 
                id: 'KZ-2601-05', 
                name: 'น.ส.ณัฐวริยา คงกล้า', 
                pos: 'หัวหน้าแผนกขาย', 
                topic: 'การสื่อสารรับออเดอร์ผิดพลาด', 
                cats: ['เพิ่มคุณภาพ', 'ลดเวลางาน'], 
                loc: 'สำนักงาน',
                problem: 'การรับออเดอร์มีความผิดพลาด เช่น ลูกค้าได้รับสินค้าไม่ตรงตามที่สั่ง ไม่ครบ หรือสั่งผิดรายการเนื่องจากสินค้ามีหลายประเภท',
                solution: '<ul><li>สอบถามรายละเอียดสินค้าให้ตรงความต้องการ ส่งรูปตัวอย่างและราคาเพื่อยืนยัน</li><li>ทำใบเสนอราคา ยืนยันออเดอร์กับลูกค้าเพื่อความถูกต้อง</li><li>ตรวจสอบรายการออเดอร์ซ้ำก่อนส่งให้ฝ่ายจัดส่ง</li></ul>',
                benefit: '<ul><li>ลดความผิดพลาดที่เกิดจากการเขียนออเดอร์ผิด</li><li>ลูกค้าได้รับสินค้าถูกต้องตามที่สั่ง</li><li>ลดเวลาในการต้องส่งสินค้าซ้ำหรือเปลี่ยนคืน</li></ul>'
            },
            { 
                id: 'KZ-2601-06', 
                name: 'นายธงชัย คุยดี', 
                pos: 'ผู้จัดการฝ่ายปฏิบัติการ', 
                topic: 'ความปลอดภัยการใช้งานของบันไดขึ้นท่อ', 
                cats: ['เพิ่มความปลอดภัย'], 
                loc: 'ร้านพัฒนาสิน',
                problem: 'บันไดขึ้นท่อ PVC เดิมไม่มีความปลอดภัย โยกเยกได้ ชันเกินไป บันไดแคบ และมีราวจับเพียงด้านเดียว เสี่ยงต่ออุบัติเหตุ',
                solution: '<ul><li>ออกแบบบันไดใหม่ให้มีมาตรฐานและปลอดภัย</li><li>มีราวจับทั้ง 2 ข้าง และมีแผ่นเหล็กกันลื่นเวลาขึ้น</li><li>ล้อบันไดสามารถล็อคเบรคได้เพื่อความมั่นคง</li></ul>',
                benefit: '<ul><li>เพื่อให้มีความปลอดภัยในการใช้งานบันได 100% ในขณะขึ้นหยิบของหรือสินค้า</li><li>พนักงานปฏิบัติงานด้วยความมั่นใจ</li></ul>'
            },
            { 
                id: 'KZ-2601-07', 
                name: 'น.ส.หนึ่งฤทัย บุตรดีคำ', 
                pos: 'พนักงานขายปลีก', 
                topic: 'ลดหนี้สินค้าขายปลีกหน้าร้าน', 
                cats: ['เพิ่มยอดขาย', 'ลดเวลางาน', 'เพิ่มคุณภาพ'], 
                loc: 'ขายปลีกหน้าร้าน',
                problem: 'ลูกค้ามักนำสินค้ามาเปลี่ยนเนื่องจากซื้อผิด หรือพนักงานหยิบผิด หรือบาร์โค้ดไม่ตรง ทำให้เกิดขั้นตอนการลดหนี้ (CN) และเสียเวลาในการทำคืนของ',
                solution: '<ul><li>พนักงานขายต้องตรวจเช็คสินค้าและสอบถามลูกค้าให้ชัดเจนก่อนคีย์บิลและรับเงิน</li><li>ตรวจสอบสินค้ากับบาร์โค้ดและราคาให้ถูกต้องตรงกันก่อนส่งมอบ</li></ul>',
                benefit: '<ul><li>ทำให้การเปลี่ยนสินค้าหรือยอดลดหนี้น้อยลง</li><li>ลดเวลาการทำงานซ้ำซ้อน</li></ul>'
            },
            { 
                id: 'KZ-2601-08', 
                name: 'นายวิชัย ทองเหล็ก', 
                pos: 'พนักงานขับรถ', 
                topic: 'จัดเรียงอุปกรณ์น้ำไทย ตามหมวดหมู่/ขนาด', 
                cats: ['ลดเวลางาน'], 
                loc: 'โกดังลูกเก่า',
                problem: 'การค้นหาสิ่งของทำได้ยากและเสียเวลา สินค้าหมวดเดียวกัน (เช่น ข้อต่อ) แต่อยู่คนละที่ หรือขนาดต่างกัน (4 หุน กับ 4 นิ้ว) วางปนกัน ทำให้หยิบผิดบ่อย',
                solution: '<ul><li>จัดเรียงสินค้าใหม่ตามหมวดหมู่ เช่น ข้อต่อตรงทุกขนาดให้อยู่แถวเดียวกัน</li><li>มีป้ายบ่งชี้โซนและหมวดหมู่สินค้าอย่างชัดเจน</li></ul>',
                benefit: '<ul><li>จัดเรียงสินค้าใหม่ให้หาเจอง่ายขึ้น</li><li>ลดเวลาในการหาสินค้า และไม่ต้องเดินหาสินค้าให้สูญเปล่า</li></ul>'
            }
        ];

        // --- 2. สร้างตาราง (Table Generation) ---
        const tableBody = document.getElementById('tableBody');
        
        kaizenData.forEach((item, index) => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-blue-50/40 transition-colors group border-b border-slate-50 last:border-b-0';
            
            // Badges
            const badges = item.cats.map(c => {
                let colorClass = 'bg-slate-100 text-slate-600 border-slate-200';
                if(c.includes('ลดเวลางาน')) colorClass = 'bg-blue-50 text-blue-600 border-blue-100';
                if(c.includes('ปลอดภัย')) colorClass = 'bg-emerald-50 text-emerald-600 border-emerald-100';
                if(c.includes('ยอดขาย')) colorClass = 'bg-rose-50 text-rose-600 border-rose-100';
                if(c.includes('คุณภาพ')) colorClass = 'bg-indigo-50 text-indigo-600 border-indigo-100';
                return `<span class="px-2 py-0.5 rounded text-[10px] font-bold border ${colorClass} mr-1 mb-1 inline-block">${c}</span>`;
            }).join('');

            row.innerHTML = `
                <td class="px-6 py-5 align-top">
                    <div class="flex flex-col">
                        <span class="text-[10px] font-mono font-bold text-slate-400 mb-1 group-hover:text-blue-500 transition-colors">${item.id}</span>
                        <div class="flex items-center gap-2">
                             <div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-xs font-bold text-slate-500 flex-shrink-0">
                                ${item.name.charAt(0)}
                             </div>
                             <div>
                                <span class="text-sm font-bold text-slate-800 block">${item.name}</span>
                                <span class="text-[11px] text-slate-500 font-medium">${item.pos}</span>
                             </div>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-5 align-top">
                    <p class="text-sm font-semibold text-slate-700 leading-relaxed mb-1">${item.topic}</p>
                    <p class="text-xs text-slate-400 line-clamp-1">${item.problem.replace(/<[^>]*>?/gm, '')}</p>
                </td>
                <td class="px-6 py-5 align-top hidden md:table-cell">
                    <div class="flex flex-wrap mb-1">${badges}</div>
                    <div class="flex items-center gap-1 text-slate-400 text-xs">
                        <i data-lucide="map-pin" class="w-3 h-3"></i> ${item.loc}
                    </div>
                </td>
                <td class="px-6 py-5 align-middle text-right">
                    <button onclick="openModal('${item.id}')" class="inline-flex items-center gap-1.5 bg-white hover:bg-blue-50 text-slate-600 hover:text-blue-600 border border-slate-200 hover:border-blue-200 px-3 py-2 rounded-lg transition-all text-xs font-bold shadow-sm group-hover:shadow-md cursor-pointer">
                        <i data-lucide="search" class="w-3.5 h-3.5"></i>
                        รายละเอียด
                    </button>
                </td>
            `;
            tableBody.appendChild(row);
        });

        // --- 3. Modal Functions ---
        const modal = document.getElementById('kaizenModal');
        const modalOverlay = document.querySelector('.modal-overlay');
        
        function openModal(id) {
            const item = kaizenData.find(d => d.id === id);
            if(!item) return;

            // Populate Data
            document.getElementById('modalId').innerText = `ID: ${item.id}`;
            document.getElementById('modalTopic').innerText = item.topic;
            document.getElementById('modalName').innerText = item.name;
            document.getElementById('modalPos').innerText = item.pos;
            document.getElementById('modalLoc').innerText = item.loc;
            
            // Use innerHTML to render HTML tags like <ul>, <li>
            document.getElementById('modalProblem').innerHTML = item.problem;
            document.getElementById('modalSolution').innerHTML = item.solution;
            document.getElementById('modalBenefit').innerHTML = item.benefit;

            // Badges in Modal
            const badgeContainer = document.getElementById('modalBadges');
            badgeContainer.innerHTML = item.cats.map(c => {
                 let colorClass = 'bg-slate-100 text-slate-600';
                if(c.includes('ลดเวลางาน')) colorClass = 'bg-blue-100 text-blue-700';
                if(c.includes('ปลอดภัย')) colorClass = 'bg-emerald-100 text-emerald-700';
                if(c.includes('ยอดขาย')) colorClass = 'bg-rose-100 text-rose-700';
                if(c.includes('คุณภาพ')) colorClass = 'bg-indigo-100 text-indigo-700';
                return `<span class="px-3 py-1 rounded-full text-xs font-bold ${colorClass}">${c}</span>`;
            }).join('');

            // Show Modal
            modal.classList.remove('opacity-0', 'pointer-events-none');
            document.querySelector('.modal-container').classList.remove('scale-95');
            document.querySelector('.modal-container').classList.add('scale-100');
            document.body.classList.add('modal-active');
        }

        function closeModal() {
            modal.classList.add('opacity-0', 'pointer-events-none');
            document.querySelector('.modal-container').classList.remove('scale-100');
            document.querySelector('.modal-container').classList.add('scale-95');
            document.body.classList.remove('modal-active');
        }

        // Close on overlay click
        modalOverlay.addEventListener('click', closeModal);

        // --- 4. กราฟ (Charts) ---
        window.onload = function() {
            lucide.createIcons();
            Chart.defaults.font.family = "'Kanit', sans-serif";
            Chart.defaults.color = '#64748b';

            new Chart(document.getElementById('objectiveChart'), {
                type: 'bar',
                data: {
                    labels: ['ลดเวลางาน', 'เพิ่มคุณภาพ', 'เพิ่มยอดขาย', 'ความปลอดภัย', 'ลดต้นทุน'],
                    datasets: [{
                        label: 'จำนวนหัวข้อ',
                        data: [5, 3, 2, 1, 1],
                        backgroundColor: ['#3b82f6', '#6366f1', '#f43f5e', '#10b981', '#f59e0b'],
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { stepSize: 1 } },
                        y: { grid: { display: false } }
                    }
                }
            });

            new Chart(document.getElementById('locationChart'), {
                type: 'doughnut',
                data: {
                    labels: ['คลังสินค้า', 'สำนักงาน', 'หน้าร้าน'],
                    datasets: [{
                        data: [3, 2, 2],
                        backgroundColor: ['#3b82f6', '#6366f1', '#f43f5e'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, padding: 20 } } }
                }
            });
        };
    </script>
     <a href="index.html" style="position: fixed; bottom: 20px; right: 20px; background-color: #198754; color: white; padding: 10px 20px; text-decoration: none; border-radius: 30px; font-weight: bold; box-shadow: 2px 2px 5px rgba(0,0,0,0.3); z-index: 9999;">
    ⟲ กลับหน้าหลัก
</body>
</html>
